<!DOCTYPE html>
<html lang="az" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Ke√ßmi≈ü ƒ∞mtahanlar</title>

    <meta name="viewport" content="width=device-width, initial-scale=1"/>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
          rel="stylesheet">

    <style>
        .search-wrapper {
            max-width: 500px;
            margin: 0 auto;
        }

        /* Light mode placeholder */
        body:not(.dark-mode) input.form-control::placeholder {
            color: #6c757d !important;
            opacity: 1;
        }

        /* Dark mode placeholder */
        body.dark-mode input.form-control::placeholder {
            color: #ffffff !important;
            opacity: 1;
        }
    </style>
</head>

<body>

<th:block th:replace="~{participant/fragments/header}"></th:block>

<div class="container-fluid mt-5 pb-5">

    <h2 class="mb-4 text-center">Ke√ßmi≈ü ƒ∞mtahanlar</h2>

    <!-- üîç AXTARI≈û (HOME ƒ∞L∆è EYNƒ∞) -->
    <div class="search-wrapper mb-4">
        <form th:action="@{/quiz/my-exams}" method="get" class="d-flex">

            <input type="text"
                   name="topic"
                   class="form-control"
                   placeholder="M√∂vzu axtar"
                   th:value="${topic}"/>

            <button type="submit" class="btn btn-primary ms-2">
                Axtar
            </button>

            <a th:href="@{/quiz/my-exams}" class="btn btn-outline-warning ms-2">
                Sƒ±fƒ±rla
            </a>

        </form>
    </div>

    <!-- INFO -->
    <div th:if="${#lists.isEmpty(results)}"
         class="alert alert-info text-center">
        H…ôl…ô ki, ke√ßmi≈ü imtahan n…ôtic…ôl…ôriniz yoxdur.
    </div>

    <!-- TABLE (SABƒ∞T H√úND√úRL√úK) -->
    <div class="table-responsive" style="min-height: 500px;">
        <table class="table table-bordered table-hover align-middle text-center">

            <thead class="table-dark">
            <tr>
                <th>#</th>
                <th>M√∂vzu</th>
                <th>√úmumi Sual</th>
                <th>D√ºzg√ºn Cavab</th>
                <th>Faiz</th>
                <th>∆ètraflƒ±</th>
            </tr>
            </thead>

            <tbody>
            <tr th:each="result, iterStat : ${results}">
                <td th:text="${iterStat.index + 1 + (currentPage * 10)}">1</td>
                <td th:text="${result.topicName}">M√∂vzu</td>
                <td th:text="${result.questionCount}">0</td>
                <td th:text="${result.correctAnswersCount}">0</td>
                <td th:text="${result.correctPercent + ' %'}">0%</td>
                <td>
                    <a th:href="@{'/quiz/participant/exam-detail/' + ${result.id}}"
                       class="btn btn-primary btn-sm">
                        Detallar
                    </a>
                </td>
            </tr>

            <tr th:if="${#lists.isEmpty(results)}">
                <td colspan="6" class="text-center">
                    M…ôlumat yoxdur
                </td>
            </tr>
            </tbody>

        </table>
    </div>

    <!-- PAGINATION (H∆èMƒ∞≈û∆è EYNƒ∞ YERD∆è ‚Äì SOLDA) -->
    <nav th:if="${totalPages > 1}" class="mt-3">
        <ul class="pagination justify-content-start mb-0">

            <li class="page-item"
                th:classappend="${currentPage == 0} ? 'disabled'">
                <a class="page-link"
                   th:href="@{/quiz/my-exams(page=${currentPage - 1}, topic=${topic})}">
                    ∆èvv…ôlki
                </a>
            </li>

            <li class="page-item"
                th:each="i : ${#numbers.sequence(0, totalPages - 1)}"
                th:classappend="${i == currentPage} ? 'active'">
                <a class="page-link"
                   th:href="@{/quiz/my-exams(page=${i}, topic=${topic})}"
                   th:text="${i + 1}">
                </a>
            </li>

            <li class="page-item"
                th:classappend="${currentPage + 1 == totalPages} ? 'disabled'">
                <a class="page-link"
                   th:href="@{/quiz/my-exams(page=${currentPage + 1}, topic=${topic})}">
                    N√∂vb…ôti
                </a>
            </li>

        </ul>
    </nav>

</div>

<th:block th:replace="~{participant/fragments/footer}"></th:block>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
